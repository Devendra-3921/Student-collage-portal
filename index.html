<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Student College Portal</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .hidden { display: none; }
    #logoutBtn {
      position: absolute;
      top: 20px;
      right: 20px;
    }
  </style>
</head>
<body>
<!-- Logout Button -->
<button id="logoutBtn" class="btn btn-danger hidden" onclick="logOut()">Log Out</button>

<!-- Login Section -->
<div id="loginSection" class="container mt-5">
  <h2>Login</h2>
  <form id="loginForm">
    <input type="text" id="loginStudentId" class="form-control" placeholder="Enter your student ID" required><br>
    <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required><br>
    <button type="submit" class="btn btn-success">Login</button>
  </form>
  <p><a href="javascript:void(0);" onclick="showSignup()">Don't have an account? Sign Up</a></p>
</div>

<!-- Signup Section -->
<div id="signupSection" class="container mt-5 hidden">
  <h2>Student Registration</h2>
  <form id="signupForm">
    <input type="text" id="signupFullName" class="form-control" placeholder="Full Name" required><br>
    <input type="text" id="signupStudentId" class="form-control" placeholder="Student ID" required><br>
    <input type="password" id="signupPassword" class="form-control" placeholder="Password" required><br>
    <button type="submit" class="btn btn-primary">Register</button>
  </form>
  <p><a href="javascript:void(0);" onclick="showLogin()">Already have an account? Login</a></p>
</div>

<!-- Admin Dashboard -->
<div id="adminDashboard" class="container mt-5 hidden">
  <h2>Admin Dashboard</h2>
  <h4>List of Students</h4>
  <table class="table table-bordered" id="studentsTable">
    <thead>
      <tr>
        <th>Student ID</th>
        <th>Full Name</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows added dynamically -->
    </tbody>
  </table>
</div>

<!-- Student Dashboard -->
<div id="studentDashboard" class="container mt-5 hidden">
  <h2>Welcome, <span id="studentName"></span></h2>

  <div id="profileSection">
    <h3>Profile</h3>
    <p><strong>Student ID:</strong> <span id="profileId"></span></p>
    <p><strong>Full Name:</strong> <span id="profileFullName"></span></p>
    <p><strong>Status:</strong> <span id="profileStatus"></span></p>
  </div>

  <div id="coursesList">
    <h3>Your Courses</h3>
  </div>

  <h3>Submit Feedback on Courses</h3>
  <form id="feedbackForm">
    <select id="courseSelect" class="form-control" required>
      <option value="">Select Your Course</option>
    </select><br>
    <select id="gradeSelect" class="form-control" required>
      <option value="">Select Grade</option>
      <option value="A">A</option>
      <option value="B">B</option>
      <option value="C">C</option>
      <option value="D">D</option>
      <option value="F">F</option>
    </select><br>
    <textarea id="feedbackMessage" class="form-control" placeholder="Enter your feedback" required></textarea><br>
    <button type="submit" class="btn btn-primary">Submit Feedback</button>
  </form>
</div>

<script>
  // Subjects
  const SUBJECTS = [
    "English", "Mathematics", "Physics", "Civics", "History",
    "Computer Science", "Biology", "Chemistry", "Geography", "Physical Education"
  ];

  // Database
  const STUDENTS_DB = JSON.parse(localStorage.getItem('studentsDB')) || [];
  const feedbackData = JSON.parse(localStorage.getItem('feedbackData')) || [];
  let currentStudent = JSON.parse(localStorage.getItem('currentStudent')) || null;

  // Show Signup
  function showSignup() {
    document.getElementById('loginSection').classList.add('hidden');
    document.getElementById('signupSection').classList.remove('hidden');
  }

  // Show Login
  function showLogin() {
    document.getElementById('signupSection').classList.add('hidden');
    document.getElementById('loginSection').classList.remove('hidden');
  }

  // Signup Form
  document.getElementById('signupForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const fullName = document.getElementById('signupFullName').value;
    const studentId = document.getElementById('signupStudentId').value;
    const password = document.getElementById('signupPassword').value;

    const exists = STUDENTS_DB.find(s => s.studentId === studentId);
    if (exists) {
      alert("Student ID already exists.");
      return;
    }

    const newStudent = {
      studentId,
      fullName,
      password,
      status: 'active',
      role: 'student',
      courses: SUBJECTS.slice(0, 5),
      grades: Array(5).fill('Not Graded')
    };

    STUDENTS_DB.push(newStudent);
    localStorage.setItem('studentsDB', JSON.stringify(STUDENTS_DB));
    alert("Registration successful! You can now login.");
    showLogin();
    document.getElementById('signupForm').reset();
  });

  // Login Form
  document.getElementById('loginForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const studentId = document.getElementById('loginStudentId').value;
    const password = document.getElementById('loginPassword').value;

    if (studentId === "admin" && password === "admin123") {
      currentStudent = { studentId: "admin", fullName: "Admin", role: "admin" };
      localStorage.setItem('currentStudent', JSON.stringify(currentStudent));
      showAdminDashboard();
      return;
    }

    const student = STUDENTS_DB.find(s => s.studentId === studentId && s.password === password);
    if (student) {
      if (student.status === 'blocked') {
        alert("Your account has been blocked.");
        return;
      }
      currentStudent = student;
      localStorage.setItem('currentStudent', JSON.stringify(currentStudent));
      showStudentDashboard();
    } else {
      alert("Invalid credentials.");
    }
  });

  // Admin Dashboard
  function showAdminDashboard() {
    document.getElementById('loginSection').classList.add('hidden');
    document.getElementById('signupSection').classList.add('hidden');
    document.getElementById('adminDashboard').classList.remove('hidden');
    document.getElementById('logoutBtn').classList.remove('hidden');
    loadStudentsTable();
  }

  // Load Students into Table
  function loadStudentsTable() {
    const tableBody = document.getElementById('studentsTable').querySelector('tbody');
    tableBody.innerHTML = "";
    STUDENTS_DB.forEach((student, index) => {
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${student.studentId}</td>
        <td>${student.fullName}</td>
        <td>${student.status}</td>
        <td>
          <button class="btn btn-sm ${student.status === 'active' ? 'btn-warning' : 'btn-success'}" 
            onclick="toggleBlock(${index})">
            ${student.status === 'active' ? 'Block' : 'Unblock'}
          </button>
          <button class="btn btn-sm btn-danger" onclick="removeStudent(${index})">Remove</button>
        </td>
      `;
      tableBody.appendChild(row);
    });
  }

  // Toggle Block/Unblock
  function toggleBlock(index) {
    STUDENTS_DB[index].status = STUDENTS_DB[index].status === 'active' ? 'blocked' : 'active';
    localStorage.setItem('studentsDB', JSON.stringify(STUDENTS_DB));
    loadStudentsTable();
  }

  // Remove Student
  function removeStudent(index) {
    if (confirm("Are you sure you want to remove this student?")) {
      STUDENTS_DB.splice(index, 1);
      localStorage.setItem('studentsDB', JSON.stringify(STUDENTS_DB));
      loadStudentsTable();
    }
  }

  // Student Dashboard
  function showStudentDashboard() {
    document.getElementById('loginSection').classList.add('hidden');
    document.getElementById('signupSection').classList.add('hidden');
    document.getElementById('studentDashboard').classList.remove('hidden');
    document.getElementById('logoutBtn').classList.remove('hidden');
    document.getElementById('studentName').textContent = currentStudent.fullName;

    document.getElementById('profileId').textContent = currentStudent.studentId;
    document.getElementById('profileFullName').textContent = currentStudent.fullName;
    document.getElementById('profileStatus').textContent = currentStudent.status;

    loadStudentData();
    loadCourseDropdown();
  }

  function loadStudentData() {
    const coursesList = document.getElementById('coursesList');
    coursesList.innerHTML = '<h3>Your Courses</h3>';
    if (currentStudent && currentStudent.courses) {
      currentStudent.courses.forEach((course, index) => {
        const div = document.createElement('div');
        div.textContent = `${course} - Grade: ${currentStudent.grades[index]}`;
        coursesList.appendChild(div);
      });
    }
  }

  function loadCourseDropdown() {
    const courseSelect = document.getElementById('courseSelect');
    courseSelect.innerHTML = '<option value="">Select Your Course</option>';
    if (currentStudent && currentStudent.courses) {
      currentStudent.courses.forEach(course => {
        const option = document.createElement('option');
        option.value = course;
        option.textContent = course;
        courseSelect.appendChild(option);
      });
    }
  }

  // Feedback Form
  document.getElementById('feedbackForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const course = document.getElementById('courseSelect').value;
    const grade = document.getElementById('gradeSelect').value;
    const message = document.getElementById('feedbackMessage').value;

    const feedback = {
      studentId: currentStudent.studentId,
      course,
      grade,
      message
    };

    feedbackData.push(feedback);
    localStorage.setItem('feedbackData', JSON.stringify(feedbackData));
    alert("Feedback submitted successfully!");
    document.getElementById('feedbackForm').reset();
  });

  // Logout
  function logOut() {
    currentStudent = null;
    localStorage.removeItem('currentStudent');
    document.getElementById('loginSection').classList.remove('hidden');
    document.getElementById('signupSection').classList.add('hidden');
    document.getElementById('studentDashboard').classList.add('hidden');
    document.getElementById('adminDashboard').classList.add('hidden');
    document.getElementById('logoutBtn').classList.add('hidden');
  }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
